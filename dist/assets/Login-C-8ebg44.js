import{d as b,c as v,a as o,b as a,w as l,K as y,L as k,l as V,M as E,g as h,u as c,n as N,N as L,O as C,e as n,h as I,r as B,P as M,k as u,Q as R,J as S}from"./index-XMcsf4iL.js";import{l as O}from"./auth-dnEQjOhZ.js";const U={class:"min-h-[calc(100vh-64px-300px)] flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 bg-muted-background"},j={class:"max-w-md w-full space-y-8 bg-background p-8 rounded-xl border border-border shadow-sm"},z={class:"space-y-4"},F={class:"flex items-center justify-between"},J={class:"text-center text-sm text-muted-foreground"},K=b({__name:"Login",setup(A){const f=S(),d=B(!1),t=M({username:"",password:"",remember:!1}),i=async()=>{var m,e;if(!t.username||!t.password){u.error("请输入账号和密码");return}d.value=!0;try{const s=await O({username:t.username,password:t.password});localStorage.setItem("token",s.token),localStorage.setItem("user",JSON.stringify({id:s.id,name:s.username,email:s.email,role:s.roles.includes("ROLE_ADMIN")?"admin":"user"})),u.success("登录成功"),f.push("/")}catch(s){u.error(((e=(m=s.response)==null?void 0:m.data)==null?void 0:e.message)||"登录失败")}finally{d.value=!1}};return(m,e)=>{const s=h,p=E,x=C,_=I,g=R("RouterLink"),w=k;return V(),v("div",U,[o("div",j,[e[8]||(e[8]=o("div",{class:"text-center"},[o("h2",{class:"text-3xl font-extrabold text-primary"},"欢迎回来"),o("p",{class:"mt-2 text-sm text-muted-foreground"}," 请登录您的 NewsHub 账号 ")],-1)),a(w,{model:t,class:"mt-8 space-y-6",onSubmit:y(i,["prevent"])},{default:l(()=>[o("div",z,[a(p,null,{default:l(()=>[a(s,{modelValue:t.username,"onUpdate:modelValue":e[0]||(e[0]=r=>t.username=r),placeholder:"用户名/邮箱","prefix-icon":c(N),size:"large"},null,8,["modelValue","prefix-icon"])]),_:1}),a(p,null,{default:l(()=>[a(s,{modelValue:t.password,"onUpdate:modelValue":e[1]||(e[1]=r=>t.password=r),type:"password",placeholder:"密码","prefix-icon":c(L),size:"large","show-password":""},null,8,["modelValue","prefix-icon"])]),_:1})]),o("div",F,[a(x,{modelValue:t.remember,"onUpdate:modelValue":e[2]||(e[2]=r=>t.remember=r)},{default:l(()=>[...e[3]||(e[3]=[n("记住我",-1)])]),_:1},8,["modelValue"]),e[4]||(e[4]=o("div",{class:"text-sm"},[o("a",{href:"#",class:"font-medium text-accent hover:text-accent/80"},"忘记密码?")],-1))]),o("div",null,[a(_,{type:"primary",class:"w-full !h-11 !text-lg",loading:d.value,onClick:i},{default:l(()=>[...e[5]||(e[5]=[n(" 登 录 ",-1)])]),_:1},8,["loading"])]),o("div",J,[e[7]||(e[7]=n(" 还没有账号? ",-1)),a(g,{to:"/register",class:"font-medium text-accent hover:text-accent/80"},{default:l(()=>[...e[6]||(e[6]=[n(" 立即注册 ",-1)])]),_:1})])]),_:1},8,["model"])])])}}});export{K as default};
