import{d as E,o as z,C as B,c as D,a as l,b as t,w as s,k as m,h as T,ab as j,r,l as h,e as p,aj as S,ak as U,f as A,af as I,a2 as M,t as _,u as N,am as P,ap as V,an as L,ae as $}from"./index-XMcsf4iL.js";import{b as q,c as F}from"./admin-Bu59Y2qZ.js";const G={class:"space-y-6"},H={class:"flex items-center justify-between"},J={class:"flex items-center gap-3"},K={class:"text-sm"},O={class:"flex justify-end mt-6"},Y=E({__name:"Comments",setup(Q){const i=r(1),c=r(10),f=r(0),u=r(!1),v=r([]),d=async()=>{u.value=!0;try{const o=await q(i.value,c.value);v.value=o.items||[],f.value=o.total||0}catch{m.error("获取评论列表失败")}finally{u.value=!1}},w=o=>{L.confirm("确定要删除这条评论吗？此操作无法撤销。","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await F(o.id),m.success("评论已删除"),d()}catch{m.error("删除失败")}}).catch(()=>{})};return z(d),B([i,c],d),(o,e)=>{const g=T,n=I,b=M,x=$,y=V,C=j,k=U;return h(),D("div",G,[l("div",H,[e[3]||(e[3]=l("h2",{class:"text-2xl font-bold text-primary"},"评论管理",-1)),t(g,{type:"primary",onClick:d},{default:s(()=>[...e[2]||(e[2]=[p("刷新列表",-1)])]),_:1})]),t(C,{shadow:"hover",class:"!border-none"},{default:s(()=>[S((h(),A(x,{data:v.value,style:{width:"100%"}},{default:s(()=>[t(n,{prop:"id",label:"ID",width:"80"}),t(n,{label:"用户",width:"160"},{default:s(({row:a})=>[l("div",J,[t(b,{size:28},{default:s(()=>[p(_((a.username||"U")[0].toUpperCase()),1)]),_:2},1024),l("span",K,_(a.username||"未知用户"),1)])]),_:1}),t(n,{prop:"articleId",label:"文章ID",width:"120"}),t(n,{prop:"content",label:"内容","min-width":"300","show-overflow-tooltip":""}),t(n,{prop:"createdAt",label:"时间",width:"180"},{default:s(({row:a})=>[p(_(new Date(a.createdAt).toLocaleString()),1)]),_:1}),t(n,{label:"操作",width:"100",fixed:"right"},{default:s(({row:a})=>[t(g,{link:"",type:"danger",icon:N(P),size:"small",onClick:R=>w(a)},{default:s(()=>[...e[4]||(e[4]=[p("删除",-1)])]),_:1},8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[k,u.value]]),l("div",O,[t(y,{"current-page":i.value,"onUpdate:currentPage":e[0]||(e[0]=a=>i.value=a),"page-size":c.value,"onUpdate:pageSize":e[1]||(e[1]=a=>c.value=a),"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",total:f.value},null,8,["current-page","page-size","total"])])]),_:1})])}}});export{Y as default};
